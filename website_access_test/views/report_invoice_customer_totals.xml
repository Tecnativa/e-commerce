<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- TODO: Print totalized invoices per customer

        EXAMPLE OUTPUT:
        - Customer A:
            · INV0001: $223.33
            · INV0002: $344.54
        - CUSTOMER B:
            · INV0004: $500.00
            - INV0010: $22.77
    -->
    <data>

        <template id="report_invoice_customer_totals">
            <t t-call="web.html_container">
                <t t-foreach="docs.mapped('partner_id')" t-as="partner_id">
                    <p><span t-esc="partner_id.name" />: <span t-esc="sum(o.amount_total for o in docs.filtered(lambda docs: docs.partner_id.id == partner_id.id))" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs.filtered(lambda docs: docs.partner_id.id == partner_id.id)[0].currency_id}" /></p>
                    <ul>
                        <t t-foreach="docs.filtered(lambda docs: docs.partner_id.id == partner_id.id)" t-as="o">
                          <li><span t-field="o.number"/>: <span t-field="o.amount_total"/></li>
                        </t>
                    </ul>
                </t>                
            </t>
        </template>

        <report
            id="tecnativa_invoices_customer_totals"
            model="account.invoice"
            string="Invoices Customer Totals"
            report_type="qweb-pdf"
            name="website_access_test.report_invoice_customer_totals"
            file="website_access_test.report_invoice_customer_totals"
            print_report_name="(object._get_report_base_filename())"
        />
    </data>
</odoo>
